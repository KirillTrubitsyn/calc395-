# 395-GK Calculator API (Render deployment)

Мини-API для расчёта процентов по ст. 395 ГК РФ с учётом изменений ключевой ставки ЦБ.  
Стек: FastAPI + Docker. Развёртывание на Render.

## Быстрый старт (локально)
```bash
export RATES_URL="https://example.com/rates_sample.csv"
pip install -r requirements.txt
uvicorn app:app --reload
```

Проверка:
- `GET /health`
- `GET /calc395?amount=10000000&start_date=2024-03-01&end_date=2024-09-01`

## Параметры
- `amount` — сумма долга (руб.), > 0
- `start_date` — дата начала (включительно), `YYYY-MM-DD`
- `end_date` — дата окончания (по умолчанию не включается)
- `end_inclusive` — `true|false` (включать ли последний день), по умолчанию `false`
- `day_count` — база дней: `365` или `ACT/365` (в текущей версии обе = деление на 365)

Ответ JSON:
```json
{
  "periods": [
    {"start": "2024-03-01", "end": "2024-07-25", "rate": 16.0, "days": 147, "interest": 644657.53},
    {"start": "2024-07-26", "end": "2024-09-01", "rate": 15.0, "days": 38, "interest": 156164.38}
  ],
  "total": 800821.91
}
```

## Render: деплой
1. Залей код в GitHub репозиторий.
2. На Render → New → Web Service → привяжи репозиторий.
3. **Environment: Docker**, порт 8080.
4. В **Environment Variables** добавь:  
   `RATES_URL=https://<твоя_публичная_ссылка>/rates_sample.csv`
5. Нажми **Create Web Service**.

## Источник ставок
По умолчанию сервис ожидает публичный CSV/JSON с колонками:
```
date_from,key_rate
2024-02-23,16.0
2024-07-26,15.0
```
Приложен файл `rates_sample.csv` как образец — обязательно **замени на актуальные данные** перед использованием в деле.

## Юридические оговорки
- Период считается по дням, конец не включается (если не указано иное).
- База 365 (по умолчанию).
- Обновление ставок лежит на стороне файла-источника; зафиксируйте URL/хеш файла для воспроизводимости в суде.
